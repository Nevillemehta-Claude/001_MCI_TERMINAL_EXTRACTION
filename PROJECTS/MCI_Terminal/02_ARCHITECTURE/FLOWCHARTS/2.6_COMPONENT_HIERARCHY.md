# 2.6 Component Hierarchy Architecture
## Tree: App.tsx → Phase Components → UXMI Library

**Node ID:** 2.6
**Category:** Frontend
**CR Impact:** CR-005 (UXMI 7-States)
**Status:** CREATED
**Version:** 1.0
**Date:** 2026-01-27

---

## Purpose

This document defines the complete React component hierarchy from the root App component through phase-specific components to the UXMI design system.

---

## Component Tree

```mermaid
graph TD
    subgraph ROOT["Root Level"]
        A[main.tsx] --> B[App.tsx]
    end

    subgraph APP["App Component"]
        B --> C[Header]
        B --> D[Navigation]
        B --> E[Main Content]
        B --> F[Footer]
        B --> G[ToastContainer]
    end

    subgraph PHASES["Phase Components"]
        E --> H{Current Phase}
        H -->|Phase 0| I[Token Capture]
        H -->|Phase 1| J[Pre-Ignition Scan]
        H -->|Phase 2| K[Ignition]
        H -->|Phase 3| L[Telemetry Dashboard]
        H -->|Phase 4| M[Shutdown Panel]
    end

    subgraph PHASE_0["Phase 0 Components"]
        I --> I1[TokenCaptureForm]
        I --> I2[TokenTimer]
        I --> I3[CredentialsHelper]
    end

    subgraph PHASE_1["Phase 1 Components"]
        J --> J1[PreIgnitionScanner]
        J1 --> J2[ScanCheckItem]
    end

    subgraph PHASE_2["Phase 2 Components"]
        K --> K1[BackendSelector]
        K --> K2[IgnitionButton]
    end

    subgraph PHASE_3["Phase 3 Components"]
        L --> L1[PositionsPanel]
        L --> L2[OrdersPanel]
        L --> L3[AccountPanel]
        L --> L4[SystemHealthPanel]
        L --> L5[MarketDataPanel]
        L --> L6[ActivityLogPanel]
    end

    subgraph PHASE_4["Phase 4 Components"]
        M --> M1[ShutdownPanel]
    end

    style ROOT fill:#e3f2fd
    style APP fill:#fff3e0
    style PHASES fill:#e8f5e9
    style PHASE_0 fill:#f3e5f5
    style PHASE_1 fill:#fce4ec
    style PHASE_2 fill:#e1f5fe
    style PHASE_3 fill:#fff8e1
    style PHASE_4 fill:#ffebee
```

---

## UXMI Component Library

```mermaid
graph TD
    subgraph UXMI["UXMI Design System (CR-005)"]
        U[uxmi/index.ts] --> U1[Button]
        U --> U2[Input]
        U --> U3[ErrorDisplay]
        U --> U4[Toast]
        U --> U5[Tooltip]
        U --> U6[Spinner]
        U --> U7[ProgressBar]
        U --> U8[ToastContainer]
    end

    subgraph STATES["7-State Matrix"]
        S1[idle]
        S2[hover]
        S3[active]
        S4[loading]
        S5[success]
        S6[error]
        S7[disabled]
    end

    U1 --> STATES
    U2 --> STATES

    style UXMI fill:#e8f5e9
    style STATES fill:#fff3e0
```

---

## File Structure

```
src/client/
├── main.tsx                     # Entry point
├── App.tsx                      # Root component
├── index.css                    # Global styles
├── lib/
│   └── sentry.ts               # Sentry client config
├── stores/
│   ├── index.ts                # Store exports
│   ├── tokenStore.ts           # Token state (CR-004)
│   ├── scannerStore.ts         # Scanner state
│   ├── ignitionStore.ts        # Ignition state
│   ├── telemetryStore.ts       # Telemetry state
│   └── shutdownStore.ts        # Shutdown state (CR-002)
└── components/
    ├── phase0/
    │   ├── index.ts
    │   ├── TokenCaptureForm.tsx
    │   ├── TokenTimer.tsx
    │   └── CredentialsHelper.tsx
    ├── phase1/
    │   ├── index.ts
    │   ├── PreIgnitionScanner.tsx
    │   └── ScanCheckItem.tsx
    ├── phase2/
    │   ├── index.ts
    │   ├── BackendSelector.tsx
    │   └── IgnitionButton.tsx
    ├── phase3/
    │   ├── index.ts
    │   ├── TelemetryDashboard.tsx
    │   ├── PositionsPanel.tsx
    │   ├── OrdersPanel.tsx
    │   ├── AccountPanel.tsx
    │   ├── SystemHealthPanel.tsx
    │   ├── MarketDataPanel.tsx
    │   └── ActivityLogPanel.tsx
    ├── phase4/
    │   ├── index.ts
    │   └── ShutdownPanel.tsx
    └── uxmi/
        ├── index.ts
        ├── Button.tsx          # 7-state (CR-005)
        ├── Input.tsx           # 7-state
        ├── ErrorDisplay.tsx    # WHAT/WHY/HOW (CR-003)
        ├── Toast.tsx           # 5000ms duration (CR-005)
        ├── Tooltip.tsx         # 300ms delay (CR-005)
        ├── Spinner.tsx
        └── ProgressBar.tsx
```

---

## Component Dependencies

| Component | Dependencies | CR Compliance |
|-----------|--------------|---------------|
| App | All phase components, ToastContainer | - |
| TokenCaptureForm | Button, Input, tokenStore | CR-001, CR-004 |
| TokenTimer | - | CR-004 |
| PreIgnitionScanner | ScanCheckItem, Button, scannerStore | - |
| BackendSelector | Button, ignitionStore | - |
| IgnitionButton | Button, ignitionStore | - |
| TelemetryDashboard | All Panel components, telemetryStore | - |
| ShutdownPanel | Button, ProgressBar, shutdownStore | CR-002 |
| Button | - | CR-005 (7-state) |
| Input | - | CR-005 (7-state) |
| ErrorDisplay | - | CR-003 (WHAT/WHY/HOW) |
| Toast | - | CR-005 (5000ms) |
| Tooltip | - | CR-005 (300ms) |

---

## Props Interface Summary

### Phase Components

| Component | Key Props |
|-----------|-----------|
| TokenCaptureForm | `onSuccess: () => void` |
| TokenTimer | `compact?: boolean`, `showRefreshButton?: boolean` |
| PreIgnitionScanner | `onComplete: (canProceed: boolean) => void`, `autoStart?: boolean` |
| BackendSelector | - (uses store) |
| IgnitionButton | `onIgnition: () => void` |
| TelemetryDashboard | `watchlist?: string[]` |
| ShutdownPanel | `onComplete: () => void` |

### UXMI Components

| Component | Key Props |
|-----------|-----------|
| Button | `state: ButtonState`, `variant`, `size`, `onClick` |
| Input | `state: InputState`, `type`, `value`, `onChange` |
| ErrorDisplay | `error: { what, why, how }` |
| Toast | `type`, `title`, `message`, `duration` |
| Tooltip | `content`, `delay` |
| Spinner | `size`, `color`, `label` |
| ProgressBar | `value`, `max`, `variant` |

---

## Render Hierarchy

```mermaid
sequenceDiagram
    participant main as main.tsx
    participant App as App.tsx
    participant Phase as Phase Component
    participant UXMI as UXMI Component
    participant Store as Zustand Store

    main->>App: Render
    App->>App: Determine currentPhase
    App->>Phase: Render Phase Component
    Phase->>Store: Read State
    Store-->>Phase: State Data
    Phase->>UXMI: Render UXMI Components
    UXMI->>UXMI: Apply 7-State Logic
    UXMI-->>Phase: Rendered UI
    Phase-->>App: Rendered Phase
    App-->>main: Complete UI
```

---

## CR-005 Compliance Points

| Timing Constant | Value | Used In |
|-----------------|-------|---------|
| Hover transition | 150ms | Button, Input |
| Active transition | 100ms | Button, Input |
| Tooltip delay | 300ms | Tooltip |
| Toast duration | 5000ms | Toast |

---

*Document ID: FLOW-2.6-HIERARCHY | Layer 2 Architecture | MCI Project*
